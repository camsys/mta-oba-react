<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MTA Bus Time | Developers > SIRI > Monitored Vehicle Journey
    </title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico" />

    <link rel="stylesheet" href="/css/bustime.css">
    <script src="/js/bustime.js"></script>
</head>
<body>
  <div class="main-body no-map">
    <header class="header" id="header">
      <div class="header-inner">
        <strong class="beta">BETA</strong>
        <a href="/" aria-label="MTA Bus Time Home" class="logo-link">
          <img id="logo" src="/img/bustime-logo.svg" alt="MTA Bus Time" class="logo"/>
        </a>
        <nav>
            <ul class="menu">
                <li><a href="/">Home</a></li>
                <li><a href="/help/text/">Text</a></li>
                <li><a href="/about/">About</a></li>
                <li><a href="/contact/">Contact</a></li>
                <li><a href="/developers/" class="active">Developers</a></li>
                <li><a href="/help/">Help</a></li>
            </ul>
        </nav>
        <a href="https://www.mta.info/" target="_blank" aria-label="MTA Home" class="mta-logo-link">
          <img src="/img/mta-logo.svg" alt="MTA" class="mta-logo" />
        </a>
      </div>
    </header>
    <div class="main-content">
      <ul class="breadcrumb">
        <li><a href="/developers/">Developers</a></li>
        <li><a href="/developers/SIRI/">SIRI</a></li>
      </ul>
      <h1 class="page-title">Monitored Vehicle Journey</h1>
      <div class="content-and-toc">
        <button id="toc-toggle" class="button icon-only" aria-hidden="true" aria-expanded="true" aria-label="Toggle Table of Contents (currently visible)" aria-pressed="true">
          <span class="svg-icon-wrap">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path d="M19.056 19.252C18.554 19.711 17.913 19.94 17.131 19.94 16.164 19.94 15.404 19.63 14.85 19.01 14.297 18.387 14.02 17.532 14.02 16.447 14.02 15.273 14.335 14.368 14.964 13.733 15.512 13.179 16.208 12.902 17.054 12.902 18.185 12.902 19.012 13.273 19.535 14.015 19.824 14.432 19.979 14.85 20 15.27H18.595C18.504 14.947 18.387 14.704 18.244 14.54 17.989 14.248 17.61 14.102 17.108 14.102 16.597 14.102 16.194 14.309 15.9 14.722 15.605 15.133 15.457 15.715 15.457 16.469 15.457 17.223 15.612 17.789 15.922 18.166 16.235 18.54 16.632 18.727 17.113 18.727 17.605 18.727 17.981 18.566 18.239 18.244 18.382 18.07 18.501 17.81 18.595 17.464H19.986C19.865 18.197 19.555 18.792 19.056 19.252ZM9.548 19.94C8.588 19.94 7.853 19.679 7.345 19.156 6.664 18.514 6.324 17.59 6.324 16.383 6.324 15.151 6.664 14.227 7.345 13.609 7.853 13.086 8.588 12.825 9.548 12.825 10.509 12.825 11.244 13.086 11.752 13.609 12.43 14.227 12.769 15.151 12.769 16.383 12.769 17.59 12.43 18.514 11.752 19.156 11.244 19.679 10.509 19.94 9.548 19.94ZM10.876 18.134C11.201 17.724 11.364 17.14 11.364 16.383 11.364 15.629 11.2 15.046 10.871 14.636 10.546 14.222 10.105 14.015 9.548 14.015 8.992 14.015 8.548 14.221 8.217 14.631 7.885 15.042 7.719 15.626 7.719 16.383 7.719 17.14 7.885 17.724 8.217 18.134 8.548 18.545 8.992 18.75 9.548 18.75 10.105 18.75 10.547 18.545 10.876 18.134ZM5.446 13.03V14.221H3.435V19.753H2.021V14.221H0V13.03H5.446Z"/><rect width="20" height="2" rx="1"/><rect width="20" height="2" y="4" rx="1"/><rect width="20" height="2" y="8" rx="1"/></svg>
          </span>
        </button>
        <nav id="toc" role="menu">
          <h2 class="toc-header">Table of Contents</h2>
          <ul class="menu toc-menu">
            <li><a href="/developers/" tabindex="0">MTA Bus Time Developer&nbsp;Access</a></span></li>
            <li><a href="/developers/gtfs-realtime/" tabindex="0">GTFS-Realtime</a></li>
            <li>
              <a href="/developers/siri/" tabindex="0">The SIRI API</a>
              <ul class="menu toc-sub-menu">
                <li><a href="/developers/siri/change-log/" tabindex="0">Change Log</a></li>
                <li><a href="/developers/siri/vehicle-monitoring/" tabindex="0">Vehicle Monitoring</a></li>
                <li><a href="/developers/siri/stop-monitoring/" tabindex="0">Stop Monitoring</a></li>
                <li><a href="/developers/siri/monitored-vehicle-journey/" tabindex="0" class="active">Monitored Vehicle Journey</a></li>
                <li><a href="/developers/siri/situation-exchange-delivery/" tabindex="0">Situation Exchange Delivery</a></li>
              </ul>
            </li>
            <li><a href="/developers/restful-api/" tabindex="0">OneBusAway "Discovery"&nbsp;API</a></li>
            <li><a href="/developers/cancelled-trip-api-features/" tabindex="0">Cancelled Trip API&nbsp;Features</a></li>
            <li><a href="/developers/archive-data/" tabindex="0">Archived Bus Time&nbsp;Data</a></li>
            <li><a href="/developers/open-source/" tabindex="0">Improving the MTA Bus Time&nbsp;System</a>
          </ul>
        </nav>
        <div class="content">
          <div class="page-content card">
            <h2>SIRI MonitoredVehicleJourney Element</h2>
            <p>The SIRI MonitoredVehicleJourney element contains most of the relevant real-time information about particular vehicles in the MTA Bus Time system.  It is used by the responses to both the <a href="/developers/siri/vehicle-monitoring/">VehicleMonitoring</a> and <a href="/developers/siri/stop-monitoring/">StopMonitoring</a> calls.  As much as possible, the values in a MonitoredVehicleJourney element correspond to the values in the MTA's GTFS data.</p>
            <p>The XML below illustrates the SIRI MonitoredVehicleJourney element.  Other notes on the contents of a MonitoredVehicleJourney follow the example.</p>
<pre><code>&lt;MonitoredVehicleJourney&gt;

  &lt;!-- The 'fully qualified' route name (GTFS agency ID + route ID) for the trip the vehicle is serving. Not intended to be customer-facing. --&gt;
  &lt;LineRef&gt;MTA NYCT_B63&lt;/LineRef&gt;

  &lt;!-- The GTFS direction for the trip the vehicle is serving --&gt;
  &lt;DirectionRef&gt;1&lt;/DirectionRef&gt;

  &lt;!-- A compound element uniquely identifying the trip the vehicle is serving --&gt;
  &lt;FramedVehicleJourneyRef&gt;

    &lt;!-- The GTFS service date for the trip the vehicle is serving --&gt;
    &lt;DataFrameRef&gt;2011-01-28&lt;/DataFrameRef&gt;

    &lt;!-- The GTFS trip ID for trip the vehicle is serving, prefixed by the GTFS agency ID --&gt;
    &lt;DatedVehicleJourneyRef&gt;MTA NYCT_20110102EA_087800_B63_0002_B63_19&lt;/DatedVehicleJourneyRef&gt;
  &lt;/FramedVehicleJourneyRef&gt;

  &lt;!-- The GTFS Shape_ID, prefixed by GTFS Agency ID --&gt;
  &lt;JourneyPatternRef&gt;MTA NYCT_B630152&lt;/JourneyPatternRef&gt;

  &lt;!-- The GTFS route_short_name --&gt;
  &lt;PublishedLineName&gt;B63&lt;/PublishedLineName&gt;

  &lt;!-- GTFS Agency_ID --&gt;
  &lt;OperatorRef&gt;MTA NYCT&lt;/OperatorRef&gt;

  &lt;!-- The GTFS stop ID for the first stop on the trip the vehicle is serving, prefixed by Agency ID  --&gt;
  &lt;OriginRef&gt;MTA_801131&lt;/OriginRef&gt;

  &lt;!-- The GTFS stop ID for the last stop on the trip the vehicle is serving, prefixed by Agency ID --&gt;
  &lt;DestinationRef&gt;MTA_801042&lt;/DestinationRef&gt;

  &lt;!-- The GTFS trip_headsign for the trip the vehicle is serving --&gt;
  &lt;DestinationName&gt;BAY RIDGE SHORE RD via 5 AV&lt;/DestinationName&gt;

  &lt;!-- If a bus has not yet departed, OriginAimedDepartureTime indicates the scheduled departure time of that bus from that terminal in ISO8601 format --&gt;
  &lt;OriginAimedDepartureTime&gt;2011-01-28T14:45:00.000-04:00&lt;/OriginAimedDepartureTime&gt;

  &lt;!-- SituationRef, present only if there is an active service alert covering this call --&gt;
  &lt;SituationRef&gt;
    &lt;SituationSimpleRef&gt;MTA NYCT_8d065d76-2813-46ee-b024-20f956232831&lt;/SituationSimpleRef&gt;
  &lt;/SituationRef&gt;

  &lt;!-- Always true --&gt;
  &lt;Monitored&gt;true&lt;/Monitored&gt;

  &lt;!-- The most recently recorded or inferred coordinates of this vehicle --&gt;
  &lt;VehicleLocation&gt;
    &lt;Longitude&gt;-73.97857&lt;/Longitude&gt;
    &lt;Latitude&gt;40.68448&lt;/Latitude&gt;
  &lt;/VehicleLocation&gt;

  &lt;!-- Vehicle bearing: 0 is East, increments counter-clockwise --&gt;
  &lt;Bearing&gt;345.7&lt;/Bearing&gt;

  &lt;!-- Indicator of whether the bus is making progress (i.e. moving, generally), not moving (with value noProgress), laying over before beginning a trip (value layover), or serving a trip prior to one which will arrive (prevTrip). --&gt;
  &lt;ProgressRate&gt;normalProgress&lt;/ProgressRate&gt;

  &lt;!-- Optional indicator of vehicle progress status.  Set to &quot;layover&quot; when the bus is in a layover waiting for its next trip to start at a terminal, and/or &quot;prevTrip&quot; when the bus is currently serving the previous trip and the information presented &#39;wraps around&#39; to the following scheduled trip. --&gt;
  &lt;ProgressStatus&gt;layover&lt;/ProgressStatus&gt;

  &lt;!-- Optional indicator of whether the bus occupancy is deemed to be &quot;full&quot;,&quot;seatsAvailable&quot; or &quot;standingAvailable&quot;. If bus occupancy information is not available, this indicator is not shown (aka hidden.)  --&gt;
  &lt;Occupancy&gt;seatsAvailable&lt;/Occupancy&gt;

  &lt;!-- The vehicle ID, preceded by the GTFS agency ID --&gt;
  &lt;VehicleRef&gt;MTA NYCT_7582&lt;/VehicleRef&gt;

  &lt;!-- Depending on the system&#39;s level of confidence, the GTFS block_id the bus is serving. Please see &quot;Transparency of Block vs. Trip-Level Assignment&quot; section below  --&gt;
  &lt;BlockRef&gt;MTA NYCT_20120902CE_JG_24900_B35-26-JG_1503&lt;/BlockRef&gt;

  &lt;!-- Call data about a particular stop --&gt;
  &lt;!-- In StopMonitoring, it is the stop of interest; in VehicleMonitoring it is the next stop the bus will make. --&gt;

  &lt;MonitoredCall&gt;

    &lt;!-- The GTFS stop ID of the stop prefixed by agency_id --&gt;
    &lt;StopPointRef&gt;MTA_308214&lt;/StopPointRef&gt;

    &lt;!-- The ordinal value of the visit of this vehicle to this stop, always 1 in this implementation --&gt;
    &lt;VisitNumber&gt;1&lt;/VisitNumber&gt;

    &lt;!-- Predicted arrival/departure times in ISO8601 format  --&gt;
    &lt;ExpectedArrivalTime&gt;2015-06-04T10:46:08.361-04:00&lt;/ExpectedArrivalTime&gt;
    &lt;ExpectedDepartureTime&gt;2015-06-04T10:46:08.361-04:00&lt;/ExpectedDepartureTime&gt;

    &lt;!-- SIRI container for extensions to the standard --&gt;
    &lt;Extensions&gt;

      &lt;!-- The MTA Bus Time extensions to show distance of the vehicle from the stop --&gt;
      &lt;Distances&gt;

        &lt;!-- The distance of the stop from the beginning of the trip/route  --&gt;
        &lt;CallDistanceAlongRoute&gt;3038.9&lt;/CallDistanceAlongRoute&gt;

        &lt;!-- The distance from the vehicle to the stop along the route, in meters --&gt;
        &lt;DistanceFromCall&gt;1101.7&lt;/DistanceFromCall&gt;

        &lt;!-- The distance displayed in the UI, see below for an additional note --&gt;
        &lt;PresentableDistance&gt;5 stops away&lt;/PresentableDistance&gt;

        &lt;!-- The number of stops on the vehicle&#39;s current trip until the stop in question, starting from 0 --&gt;
        &lt;StopsFromCall&gt;5&lt;/StopsFromCall&gt;
      &lt;/Distances&gt;
    &lt;/Extensions&gt;

  &lt;/MonitoredCall&gt;

  &lt;!-- The collection of calls that a vehicle is going to make.  --&gt;
  &lt;OnwardCalls&gt;

    &lt;!-- A stop that the vehicle is going to make, if the detailLevel is set to calls  --&gt;
    &lt;OnwardCall&gt;

      &lt;!-- The GTFS stop ID of the stop --&gt;
      &lt;StopPointRef&gt;MTA_308215&lt;/StopPointRef&gt;

      &lt;!-- The ordinal value of the visit of this vehicle to this stop, always 1 in this implementation --&gt;
      &lt;VisitNumber&gt;1&lt;/VisitNumber&gt;

      &lt;!-- The GTFS stop name of the stop --&gt;
      &lt;StopPointName&gt;5 AV - GARFIELD PL&lt;/StopPointName&gt;

      &lt;!-- SIRI container for extensions to the standard --&gt;
      &lt;Extensions&gt;

        &lt;!-- The MTA Bus Time extensions to show distance of the vehicle from the stop --&gt;
        &lt;Distances&gt;

          &lt;!-- The distance of the stop from the beginning of the trip/route  --&gt;
          &lt;CallDistanceAlongRoute&gt;3267.1&lt;/CallDistanceAlongRoute&gt;

          &lt;!-- The distance from the vehicle to the stop along the route, in meters --&gt;
          &lt;DistanceFromCall&gt;1329.9&lt;/DistanceFromCall&gt;

          &lt;!-- The distance displayed in the UI --&gt;
          &lt;PresentableDistance&gt;6 stops away&lt;/PresentableDistance&gt;

          &lt;!-- The number of stops on the vehicle&#39;s current trip until the stop in question, starting from 0 --&gt;
          &lt;StopsFromCall&gt;6&lt;/StopsFromCall&gt;
        &lt;/Distances&gt;
      &lt;/Extensions&gt;

    &lt;/OnwardCall&gt;

    ... more OnwardCalls

  &lt;/OnwardCalls&gt;
&lt;/MonitoredVehicleJourney&gt;</code></pre>
            <h3>The PresentableDistance field:</h3>
            <p>The logic that determines whether stops or miles are shown in the PresentableDistance field is below:</p>
            <p>show distance in miles if and only if:</p>
            <ul>
              <li><code>(distance in miles to _immediate next stop_ is &gt; D) OR (distance in stops to current stop is &gt; N AND distance in miles to current stop &gt; E)</code></li>
            </ul>
            <p>in other words, show distance in stops if and only if (the below is just the inverse of the above, according to DeMorgan's law):</p>
            <ul>
              <li><code>(distance in miles to _immediate next stop_ is &lt;= D) AND (distance in stops to current stop &lt;= N OR distance in miles to current stop &lt;= E)</code></li>
            </ul>
            <p>Show "approaching" if and only if:</p>
            <ul>
              <li><code>distance_in_miles to immediate next stop &lt; P</code></li>
            </ul>
            <p>show "at stop" if and only if:</p>
            <ul>
              <li><code>distance_in_miles to immediate next stop &lt; T</code></li>
            </ul>
            <p>Current Parameter Values:</p>
            <table>
              <tbody>
                <tr>
                  <th scope="col">Parameter</th>
                  <th scope="col">Value</th>
                </tr>
                <tr>
                  <td>D</td>
                  <td>.5 miles</td>
                </tr>
                <tr>
                  <td>N</td>
                  <td>3 stops</td>
                </tr>
                <tr>
                  <td>E</td>
                  <td>.5 miles</td>
                </tr>
                <tr>
                  <td>P</td>
                  <td>500 feet</td>
                </tr>
                <tr>
                  <td>T</td>
                  <td>100 feet</td>
                </tr>
              </tbody>
            </table>
            <h3>Transparency of Block vs. Trip-Level Assignment</h3>
            <p>MTA Bus Time tries to assign buses to blocks- a sequence of trips that start and end at a depot. This allows the system to make a statement about what a bus will do after it reaches the end of its current trip.</p>
            <p>However, there is not always enough affirmative and corresponding evidence to make such a strong statement. In this case, MTA Bus Time falls back to a trip-level assignment, where it just picks a trip from the schedule that is representative of the route and stopping pattern that the bus is likely to pursue.</p>
            <p>The SIRI API now reflects this distinction as described here and in other items below. If the assignment is block-level, the new <code>BlockRef</code> field of the <code>MonitoredVehicleJourney</code> is present, and populated with the assigned block id.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
